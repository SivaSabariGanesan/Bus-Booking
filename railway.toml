[build]
builder = "nixpacks"

[deploy]
startCommand = "chmod +x backend/start.sh && backend/start.sh"
healthcheckPath = "/health/"
healthcheckTimeout = 100
restartPolicyType = "on_failure"
restartPolicyMaxRetries = 10

[deploy.preDeploy]
cmds = [
    "python backend/manage.py migrate --settings=transport_booking.settings_production --noinput"
]

[env]
DJANGO_SETTINGS_MODULE = "transport_booking.settings_production"
